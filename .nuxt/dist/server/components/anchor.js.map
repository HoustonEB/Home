{"version":3,"file":"components/anchor.js","sources":["webpack:///./components/Anchor/index.vue?47e0","webpack:///./components/Anchor/index.vue?f698","webpack:///./components/Anchor/index.vue?2621","webpack:///./components/Anchor/index.vue","webpack:///./components/Anchor/index.vue?e513","webpack:///./components/Anchor/index.vue?ce39"],"sourcesContent":["// Exports\nmodule.exports = {\n\n};\n","export * from \"-!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-0!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-1!../../node_modules/sass-loader/dist/cjs.js??ref--7-oneOf-1-2!../../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=a2aa7e88&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:[_vm.classPrefix + '-anchor-wrapper']},[_vm._ssrNode(\"<p class=\\\"catalog-title\\\" data-v-a2aa7e88>目录</p> <div class=\\\"catalog-body\\\" data-v-a2aa7e88><ul data-v-a2aa7e88>\"+(_vm._ssrList((_vm.catalogData),function(ref){\nvar id = ref.id;\nvar title = ref.title;\nvar level = ref.level;\nreturn (\"<li\"+(_vm._ssrClass(null,[_vm.activeLinkId === '#' + id ? 'active' : '']))+\" data-v-a2aa7e88><a\"+(_vm._ssrAttr(\"href\",['#' + id]))+(_vm._ssrAttr(\"title\",title))+(_vm._ssrClass(null,[\n                    'catalog-link',\n                    'ellipsis',\n                    'level-' + level\n                ]))+\" data-v-a2aa7e88>\"+_vm._ssrEscape(\"\\n                \"+_vm._s(title)+\"\\n            \")+\"</a></li>\")}))+\"</ul></div>\")])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport throttle from 'loadsh/throttle';\nexport default {\n    props: {\n        classPrefix: {\n            type: String,\n            default: 'blog',\n        },\n        catalogData: {\n            type: Array,\n            default: [],\n        }\n    },\n    computed: {\n        activeLinkId: function () {\n            return this.isExitDomIds[this.isExitDomIds.length - 1] || '#heading'\n        }\n    },\n    data: function () {\n        return {\n            anchorDoms: [],\n            isExitDomIds: [],\n            anchorUlTop: 0\n        }\n    },\n    methods: {\n        linkClick: function (id, e) {\n            // e.preventDefault();\n            // let scrollTop = document.documentElement.scrollTop || document.body.scrollTop;\n            let scrollHeadDom = document.getElementById(id)\n            let top = scrollHeadDom.getBoundingClientRect().top\n\n            window.scrollBy({top: top - 120, left: 0, behavior: 'smooth'})\n        },\n        scroll: throttle(function () {\n            let clientHeight = document.documentElement.clientHeight || document.body.clientHeight // 视口的高度\n            let catalogBodyUl = document.querySelectorAll('.catalog-body ul')[0];\n            let visibleUlHeight = clientHeight - this.anchorUlTop;\n            let catalogBody = document.querySelectorAll('.catalog-body')[0];\n            let catalogBodyHeight = catalogBody.offsetHeight;\n            let catalogLiHeight = document.querySelectorAll('.catalog-body li')[0].offsetHeight;\n            let halfActiveIdx = Math.round((visibleUlHeight / catalogLiHeight) / 2);\n            let activeIdx = 0;\n            this.isExitDomIds = this.anchorDoms\n            .map((item) => {\n                let top = item.getBoundingClientRect().top // 与视口顶部的距离\n                let bottom = item.getBoundingClientRect().bottom\n\n                if (top <= 150) {\n                    return '#' + item.getAttribute('id')\n                }\n            })\n            .filter(Boolean)\n            this.catalogData.forEach((item, index) => {\n                if(item.id === this.activeLinkId.substr(1)) {\n                    activeIdx = index + 1;\n                }\n                });\n            if(activeIdx > halfActiveIdx) {\n                catalogBodyUl.style.marginTop = -((activeIdx - halfActiveIdx) * catalogLiHeight) + 'px';\n            } else {\n                catalogBodyUl.style.marginTop = '0px';\n            }\n            // console.log(halfActiveIdx, 'halfActiveIdx', activeIdx);\n            // console.log(this.isExitDomIds)\n        }, 50),\n        getAnchorDom: function () {\n            let domArr = this.catalogData.map((item) => {\n                return document.getElementById(`${item.id}`)\n            })\n            this.anchorDoms = [...domArr]\n        },\n    },\n    mounted: function () {\n        let catalogBodyUl = document.querySelectorAll('.catalog-body ul')[0];\n        this.anchorUlTop = catalogBodyUl.getBoundingClientRect().top;\n        window.document.addEventListener('scroll', this.scroll)\n    },\n    updated: function () {\n        this.getAnchorDom()\n        this.anchorDoms.forEach((item) => {\n            item.children[0].onclick = (e) => {\n                e.preventDefault()\n                this.linkClick(item.id)\n            }\n        });\n    },\n    destroyed: function () {\n        window.document.removeEventListener('scroll', this.scroll)\n    },\n}\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=a2aa7e88&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  var style0 = require(\"./index.vue?vue&type=style&index=0&id=a2aa7e88&lang=scss&scoped=true&\")\nif (style0.__inject__) style0.__inject__(context)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  \"a2aa7e88\",\n  \"bd5f9468\"\n  \n)\n\nexport default component.exports"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;;;;;;;;;ACHA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAFA;AALA;AAUA;AACA;AACA;AACA;AAHA;AAKA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AA9CA;AAgDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAvFA;;AC3BA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}